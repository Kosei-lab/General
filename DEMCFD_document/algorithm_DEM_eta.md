# 粘弾性係数 \(\eta\)の算出

粘弾性係数 \(\eta\)は反発係数とばね定数などから求められます。DEMでは反発係数の方が粘弾性係数より直感的に分かりやすいため、反発係数をパラメーターとして設定し、\(\eta\)をそこから算出するのが一般的です。

はじめに結論から述べると、粘弾性係数 \(\eta\)は以下の式によって計算されます。

\[ \eta=-2   \frac{\sqrt{(m^* k)}\ln e}{\sqrt{(\pi^2+(\ln e)^2)}}\]

では、この式はどうやって導かれるかを追っていきましょう。プロセスとしては、2粒子間衝突において微分方程式から出る解と反発係数から出る解を比較することで\(\eta\)と\(e\)の関係を導きます。

まず2粒子間衝突を考えます。(壁面との衝突は片方の質量を無限大とすればよいです)このとき、運動方程式は

\[ m_1 \frac{d^2x_1}{dt^2} =-k(x_1-x_2)-\eta \frac{d(x_1-x_2)}{dt}\]
\[ m_2 \frac{d^2x_2}{dt^2} =-k(x_2-x_1)-\eta \frac{d(x_2-x_1)}{dt}\]

となります。今回は反発係数との比較を行うために重力などの外力項は存在しません。
(高校物理の)二体問題の常套手段として重心座標系で表すと、

\[ m^* \frac{d^2x_r}{dt^2} =-kx_r-\eta \frac{dx_r}{dt}\]
\[ (m_1+m_2)\frac{d^2x_G}{dt^2} =0\]

です。\(m^*\)は換算質量

\[ m^* =\frac{m_1m_2}{m_1+m_2}\]

です。

外力がないので重心位置は一定で、解くべきは相対位置に対する微分方程式のみとなります。

この方程式は定数係数線形二階微分方程式ですので、初期条件があれば解くことが可能です。

\[ x_r = \frac{v_0}{q} \sin{(qt)}\exp{(\gamma \omega t)}+x_0\]

\[ \omega =\sqrt{\frac{k}{m^*}},\gamma =\frac{\eta}{2\sqrt{m^*k}}, q=\omega\sqrt{1-\gamma^2} \]

減衰振動においては過減衰などの解もありますが、反発係数と比較するということは反発することを前提としていますので、\(\eta\)は振動解の範囲にあるとしています。

上記の解より、速度は

\[ v_r=\frac{dx_r}{dt} = \frac{v_0}{q} \exp{(\gamma \omega t)}(q\cos{(qt)}-\gamma\omega\sin{(qt)})\]

反発するときの速度は半周期後\(t=\pi/q\)での速度で、

\[ v_r(t_c)= v_0 \exp{ \left( \frac{-\gamma \omega \pi}{q} \right) }=v_0 \exp{ \left( \frac{-\gamma \omega \pi}{\sqrt{1-\gamma^2}} \right) }\]

同様に反発係数から反発速度を求めると、

\[ v_r(t_c)= ev_0\]

ですので、この２式から

\[\gamma=-\frac{\ln{e}}{\sqrt{\pi^2+(\ln{e})^2}}\]

よって最終的に

\[ \eta=-2   \frac{\sqrt{(m^* k)}\ln e}{\sqrt{(\pi^2+(\ln e)^2)}}\]

となります。以上で導くことができました。
もちろん、この部分をすべてシミュレーション内で計算しているわけではなく、上式のみを用いて以下の関数で粘弾性係数を計算しています。

```
dem_part_part_damper_coef()
dem_part_wall_damper_coef()
```
## 参考

http://www-mupf.mech.eng.osaka-u.ac.jp/jugyo/11-2.pdf
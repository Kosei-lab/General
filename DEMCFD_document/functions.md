# 実装されている独自機能(論文引用)
このソルバーには通常のDEM-CFD法に加えていくつかの独自機能が追加されています。
現在、私が理解している範囲で実装している機能と論文を紐付けた形で記述します。
1. DEM粗視化モデル ([Sakai and koshizuka, 2009][CGM_pneumatic],[Sakai, et al., 2014][CGM_Validation])

    [CGM_pneumatic]:https://doi.org/10.1016/j.ces.2008.10.003
    [CGM_Validation]:https://doi.org/10.1016/j.cej.2014.01.029
    
    * 実粒子群を1つの代表粒子に計算することで計算粒子数を大幅に削減する手法です。\(l\) 倍大きな粒子を用いる際に粗視化率を\(l\)とし、これを用いることでDEMの支配方程式が以下のようになります。

    \[ m_{CGM} a=l^3 \left\{ \sum{\bf{F_c}} +\bf{F_d} +V_S \nabla p +m_{CGM} \bf{g} \right\} \]

    * これはDEMの支配方程式の左辺が\(l^3\)された形ですので、容易に実装が可能であることが分かるかと思います。ここで特に注意すべき点は、\(l^3\)個の粒子がお互いに衝突することを仮定しているために計算上使用されるばね定数が\(l^3k\)になること、そして流体抗力の計算においてはオリジナルの粒子径が用いられることです。特に前者はタイムステップの決定に、後者は固気混相流において粗視化モデルが効果を発揮する大きな点となっています。
    * 実装はDEMを中心にほとんど全体に対して行われています。 granular->coarseRatio が粗視化率を示しています。

2. リンクリスト ([Shigeto and Sakai, 2011][Linked_shigeto])

    [Linked_shigeto]:https://doi.org/10.1016/j.partic.2011.04.002
    
    * リンクリストはDEMの接触判定を効率化する目的で導入された手法です。DEMにおいて一般的に用いられる接触判定格子に対して、その内部の粒子IDが次の粒子IDへのリンクを持つような連結リスト構造を生成することにより、セル数×入り得る最大の粒子数という膨大なメモリ量が必要だった接触判定格子のメモリ消費量を削減することが可能になりました。
    * 実装はDEM全体に対して行われており、固体粒子の存在するセルの判定、接触判定などがこの手法で行われています。
    * リンクリストの都合上、DEM周期境界条件の実装が困難になっている可能性が示唆されています(要確認)。周期境界が必要な場合はDEM-DNSコードを用いてください。
        * ただし、そもそもDEMの全面周期境界は煩雑になる傾向があるため(特に頂点、辺上での移動)、DEM-DNSコードにおいても2面周期境界までしか実装されていません。特殊用途用に作成した全面周期境界のDEM-DNSが森のローカルには存在しますので、必要があれば相談ください。

3. SDF(符号付き距離関数)([Shigeto and Sakai, 2013][SDF_shigeto])

    [SDF_shigeto]:https://doi.org/10.1016/j.cej.2013.07.073
    * DEMにおける任意形状壁面の解析を構造格子によって行うことを可能にした手法です。

4. IBM(埋め込み境界法)([Yao,et al., 2018][Yao_DieFilling]が初出？)

    [Yao_DieFilling]:https://doi.org/10.1016/j.jtice.2017.11.031
    * CFD/VOFにおいて任意形状壁面の解析を構造格子によって行うことを可能にした手法です。元来は壁面が複雑に変形するような体系のために作成された手法ですが、本ソルバーにおいてはオブジェクトの剛体回転のみがサポートされています。

5. 密度スケーリング([Sun and Sakai, 2017][DensScaling])

    [DensScaling]:https://doi.org/10.1252/jcej.16we115
    * IBMにおいては壁面がセル内に埋め込まれて計算されるため、壁面もセルとして計算されます。ナビエ-ストークス方程式において圧力の境界条件はノイマン境界条件(\(\nabla p=0\))ですが、これがアルゴリズム内で陽に表現されないため、圧力が壁面内に染み出してしまう場合が存在します。これを防ぐ手法として考案されたのが密度スケーリングです。
    * 壁面において、流体密度を人工的に大きくすることで、壁面への圧力浸透を防止します。この手法は論文でも説明されている通り、空隙率\(\varepsilon=\rho / \hat{\rho} \)を壁面内においておおよそ0に近づけているとして理解することができます。
    * 計算効率・計算精度の面からスケーリング係数は1000程度がよいという結論が得られています。

6. 異なる粒子径間の液架橋力モデル([Sun and Sakai, 2018][LiquidBridge_Sun])
    
    [LiquidBridge_Sun]:https://doi.org/10.1016/j.ces.2018.02.034

    * 
* **(未発表分)**

1. 抗力陰解法
    * 流体抗力を陰的に解くことにより、計算を安定化させる手法です。
    * 陰的に解くことにより解がなめる可能性がありますが、少なくとも準定常状態に関しては問題ないであろうことが経験的に知られています。どの程度のタイムステップまでが許容範囲内かは未検証状態です。
    * 特に粗視化モデルを使用した際、流体抗力が粒子径に対して非常に大きくなるため、この手法が必要になる可能性があります。
2. 回転抵抗に対する粗視化モデル
    * (未検証)
3. 付着力に対する粗視化モデル
    * (未検証)
4. 多孔質体
    * (未検証)